let t,e,i,s;var r,n,o,a,h,c,l,u,d,p,f,y,m,g,v,x,b,z,_,w,M,E,O,A,S,P,T,j,C,B,R,V,I,F,D,k,Z,q,L=globalThis;function N(t){return t&&t.__esModule?t.default:t}function U(t,e,i,s){Object.defineProperty(t,e,{get:i,set:s,enumerable:!0,configurable:!0})}var J={},Q={},Y=L.parcelRequire5431;null==Y&&((Y=function(t){if(t in J)return J[t].exports;if(t in Q){var e=Q[t];delete Q[t];var i={id:t,exports:{}};return J[t]=i,e.call(i.exports,i,i.exports),i.exports}var s=Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(t,e){Q[t]=e},L.parcelRequire5431=Y);var X=Y.register;X("f504n",function(t,e){var i=Y("23YZo"),s=Y("fiQnm"),r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?i.Buffer:void 0,a=o?o.isBuffer:void 0;t.exports=a||s}),X("23YZo",function(t,e){var i=Y("ljJ8G"),s="object"==typeof self&&self&&self.Object===Object&&self,r=i||s||Function("return this")();t.exports=r}),X("ljJ8G",function(t,e){var i="object"==typeof L&&L&&L.Object===Object&&L;t.exports=i}),X("fiQnm",function(t,e){t.exports=function(){return!1}}),X("jIny1",function(t,e){var i=Y("ljJ8G"),s=e&&!e.nodeType&&e,r=s&&t&&!t.nodeType&&t,n=r&&r.exports===s&&i.process,o=function(){try{var t=r&&r.require&&r.require("util").types;if(t)return t;return n&&n.binding&&n.binding("util")}catch(t){}}();t.exports=o});var H=Y("ilwiq");const G="Alpha",W="Attraction",$="Color",K="CrossZone",tt="Force",te="Gravity",ti="RandomDrift",ts="Repulsion",tr="Rotate",tn="Scale",to="Spring",ta="Body",th="BodySprite",tc="Texture",tl="Life",tu="Mass",td="Position",tp="Radius",tf="VectorVelocity",ty="PolarVelocity",tm="RadialVelocity",tg=[th,tc],tv="BoxZone",tx="LineZone",tb="MeshZone",tz="PointZone",t_="SphereZone";var tw={},tM=tw={};function tE(){throw Error("setTimeout has not been defined")}function tO(){throw Error("clearTimeout has not been defined")}function tA(t){if(F===setTimeout)return setTimeout(t,0);if((F===tE||!F)&&setTimeout)return F=setTimeout,setTimeout(t,0);try{return F(t,0)}catch(e){try{return F.call(null,t,0)}catch(e){return F.call(this,t,0)}}}!function(){try{F="function"==typeof setTimeout?setTimeout:tE}catch(t){F=tE}try{D="function"==typeof clearTimeout?clearTimeout:tO}catch(t){D=tO}}();var tS=[],tP=!1,tT=-1;function tj(){tP&&k&&(tP=!1,k.length?tS=k.concat(tS):tT=-1,tS.length&&tC())}function tC(){if(!tP){var t=tA(tj);tP=!0;for(var e=tS.length;e;){for(k=tS,tS=[];++tT<e;)k&&k[tT].run();tT=-1,e=tS.length}k=null,tP=!1,function(t){if(D===clearTimeout)return clearTimeout(t);if((D===tO||!D)&&clearTimeout)return D=clearTimeout,clearTimeout(t);try{D(t)}catch(e){try{return D.call(null,t)}catch(e){return D.call(this,t)}}}(t)}}function tB(t,e){this.fun=t,this.array=e}function tR(){}tM.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];tS.push(new tB(t,e)),1!==tS.length||tP||tA(tC)},tB.prototype.run=function(){this.fun.apply(null,this.array)},tM.title="browser",tM.browser=!0,tM.env={},tM.argv=[],tM.version="",tM.versions={},tM.on=tR,tM.addListener=tR,tM.once=tR,tM.off=tR,tM.removeListener=tR,tM.removeAllListeners=tR,tM.emit=tR,tM.prependListener=tR,tM.prependOnceListener=tR,tM.listeners=function(t){return[]},tM.binding=function(t){throw Error("process.binding is not supported")},tM.cwd=function(){return"/"},tM.chdir=function(t){throw Error("process.chdir is not supported")},tM.umask=function(){return 0};const tV=3.142/180,tI="euler",tF=()=>!!tw&&(tw.env,!1),tD={easeLinear:function(t){return t},easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInSine:function(t){return-Math.cos(1.571*t)+1},easeOutSine:function(t){return Math.sin(1.571*t)},easeInOutSine:function(t){return -.5*(Math.cos(3.142*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInBack:function(t){return t*t*(2.70158*t-1.70158)},easeOutBack:function(t){return(t-=1)*t*(2.70158*t+1.70158)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)}},{easeLinear:tk,easeInQuad:tZ,easeOutQuad:tq,easeInOutQuad:tL,easeInCubic:tN,easeOutCubic:tU,easeInOutCubic:tJ,easeInQuart:tQ,easeOutQuart:tY,easeInOutQuart:tX,easeInSine:tH,easeOutSine:tG,easeInOutSine:tW,easeInExpo:t$,easeOutExpo:tK,easeInOutExpo:t1,easeInCirc:t0,easeOutCirc:t2,easeInOutCirc:t5,easeInBack:t4,easeOutBack:t3,easeInOutBack:t9}=tD,t8=t=>tD[t]?tD[t]:tD.easeLinear,t6=1/0,t7=[td,tl,tp,tu,ta,th,tc,ty,tm,tf],et=[G,W,$,K,tt,te,ti,ts,tr,tn,to],ee=[tv,tx,tb,tz,t_];var ei={};(ei=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}).__esModule=!0,ei.default=ei;var es={getRGB:function(t){var e,i={};if("number"==typeof t)s=Math.floor(t),i.r=(t>>16&255)/255,i.g=(t>>8&255)/255,i.b=(255&t)/255;else if("string"==typeof t){if(e=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(t))i.r=Math.min(255,parseInt(e[1],10))/255,i.g=Math.min(255,parseInt(e[2],10))/255,i.b=Math.min(255,parseInt(e[3],10))/255;else if(e=/^\#([A-Fa-f0-9]+)$/.exec(t)){var s=e[1];i.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,i.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,i.b=parseInt(s.charAt(4)+s.charAt(5),16)/255}}else i.r=t.r,i.g=t.g,i.b=t.b;return i}},er={_id:0,_uids:new Map,getNewId:function(){return`PUID_${++this._id}`},id:function(t){if(this._uids.has(t))return this._uids.get(t);let e=this.getNewId();return this._uids.set(t,e),e}},en={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,s=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&s|128]+t[s>>8&255]+"-"+t[s>>16&255]+t[s>>24&255]+t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255]).toUpperCase()}}(),clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,s,r){return s+(t-e)*(r-s)/(i-e)},lerp:function(t,e,i){return(1-i)*t+i*e},smoothstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*en.DEG2RAD},radToDeg:function(t){return t*en.RAD2DEG},isPowerOfTwo:function(t){return(t&t-1)==0&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function eo(t,e,i,s){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==s?s:1}function ea(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}function eh(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function ec(t,e,i,s){this._x=t||0,this._y=e||0,this._z=i||0,this._order=s||ec.DefaultOrder}Object.assign(eo,{slerp:function(t,e,i,s){return i.copy(t).slerp(e,s)},slerpFlat:function(t,e,i,s,r,n,o){var a=i[s+0],h=i[s+1],c=i[s+2],l=i[s+3],u=r[n+0],d=r[n+1],p=r[n+2],f=r[n+3];if(l!==f||a!==u||h!==d||c!==p){var y=1-o,m=a*u+h*d+c*p+l*f,g=m>=0?1:-1,v=1-m*m;if(v>Number.EPSILON){var x=Math.sqrt(v),b=Math.atan2(x,m*g);y=Math.sin(y*b)/x,o=Math.sin(o*b)/x}var z=o*g;if(a=a*y+u*z,h=h*y+d*z,c=c*y+p*z,l=l*y+f*z,y===1-o){var _=1/Math.sqrt(a*a+h*h+c*c+l*l);a*=_,h*=_,c*=_,l*=_}}t[e]=a,t[e+1]=h,t[e+2]=c,t[e+3]=l}}),Object.defineProperties(eo.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(eo.prototype,{isQuaternion:!0,set:function(t,e,i,s){return this._x=t,this._y=e,this._z=i,this._w=s,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!(t&&t.isEuler))throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t._x,s=t._y,r=t._z,n=t.order,o=Math.cos,a=Math.sin,h=o(i/2),c=o(s/2),l=o(r/2),u=a(i/2),d=a(s/2),p=a(r/2);return"XYZ"===n?(this._x=u*c*l+h*d*p,this._y=h*d*l-u*c*p,this._z=h*c*p+u*d*l,this._w=h*c*l-u*d*p):"YXZ"===n?(this._x=u*c*l+h*d*p,this._y=h*d*l-u*c*p,this._z=h*c*p-u*d*l,this._w=h*c*l+u*d*p):"ZXY"===n?(this._x=u*c*l-h*d*p,this._y=h*d*l+u*c*p,this._z=h*c*p+u*d*l,this._w=h*c*l-u*d*p):"ZYX"===n?(this._x=u*c*l-h*d*p,this._y=h*d*l+u*c*p,this._z=h*c*p-u*d*l,this._w=h*c*l+u*d*p):"YZX"===n?(this._x=u*c*l+h*d*p,this._y=h*d*l+u*c*p,this._z=h*c*p-u*d*l,this._w=h*c*l-u*d*p):"XZY"===n&&(this._x=u*c*l-h*d*p,this._y=h*d*l-u*c*p,this._z=h*c*p+u*d*l,this._w=h*c*l+u*d*p),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,s=Math.sin(i);return this._x=t.x*s,this._y=t.y*s,this._z=t.z*s,this._w=Math.cos(i),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,i=t.elements,s=i[0],r=i[4],n=i[8],o=i[1],a=i[5],h=i[9],c=i[2],l=i[6],u=i[10],d=s+a+u;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(l-h)*e,this._y=(n-c)*e,this._z=(o-r)*e):s>a&&s>u?(e=2*Math.sqrt(1+s-a-u),this._w=(l-h)/e,this._x=.25*e,this._y=(r+o)/e,this._z=(n+c)/e):a>u?(e=2*Math.sqrt(1+a-s-u),this._w=(n-c)/e,this._x=(r+o)/e,this._y=.25*e,this._z=(h+l)/e):(e=2*Math.sqrt(1+u-s-a),this._w=(o-r)/e,this._x=(n+c)/e,this._y=(h+l)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var i=t.dot(e)+1;return i<1e-6?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x),this._w=i,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(en.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var i=this.angleTo(t);if(0===i)return this;var s=Math.min(1,e/i);return this.slerp(t,s),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,s=t._y,r=t._z,n=t._w,o=e._x,a=e._y,h=e._z,c=e._w;return this._x=i*c+n*o+s*h-r*a,this._y=s*c+n*a+r*o-i*h,this._z=r*c+n*h+i*a-s*o,this._w=n*c-i*o-s*a-r*h,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,s=this._y,r=this._z,n=this._w,o=n*t._w+i*t._x+s*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=n,this._x=i,this._y=s,this._z=r,this;var a=1-o*o;if(a<=Number.EPSILON){var h=1-e;return this._w=h*n+e*this._w,this._x=h*i+e*this._x,this._y=h*s+e*this._y,this._z=h*r+e*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(a),l=Math.atan2(c,o),u=Math.sin((1-e)*l)/c,d=Math.sin(e*l)/c;return this._w=n*u+this._w*d,this._x=i*u+this._x*d,this._y=s*u+this._y*d,this._z=r*u+this._z*d,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(ea.prototype,{isVector3:!0,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:(o=new eo,function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(o.setFromEuler(t))}),applyAxisAngle:(a=new eo,function(t,e){return this.applyQuaternion(a.setFromAxisAngle(t,e))}),applyMatrix3:function(t){var e=this.x,i=this.y,s=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*s,this.y=r[1]*e+r[4]*i+r[7]*s,this.z=r[2]*e+r[5]*i+r[8]*s,this},applyMatrix4:function(t){var e=this.x,i=this.y,s=this.z,r=t.elements,n=1/(r[3]*e+r[7]*i+r[11]*s+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*s+r[12])*n,this.y=(r[1]*e+r[5]*i+r[9]*s+r[13])*n,this.z=(r[2]*e+r[6]*i+r[10]*s+r[14])*n,this},applyQuaternion:function(t){var e=this.x,i=this.y,s=this.z,r=t.x,n=t.y,o=t.z,a=t.w,h=a*e+n*s-o*i,c=a*i+o*e-r*s,l=a*s+r*i-n*e,u=-r*e-n*i-o*s;return this.x=h*a+-(u*r)+-(c*o)- -(l*n),this.y=c*a+-(u*n)+-(l*r)- -(h*o),this.z=l*a+-(u*o)+-(h*n)- -(c*r),this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,i=this.y,s=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*s,this.y=r[1]*e+r[5]*i+r[9]*s,this.z=r[2]*e+r[6]*i+r[10]*s,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var i=t.x,s=t.y,r=t.z,n=e.x,o=e.y,a=e.z;return this.x=s*a-r*o,this.y=r*n-i*a,this.z=i*o-s*n,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:(h=new ea,function(t){return h.copy(this).projectOnVector(t),this.sub(h)}),reflect:(c=new ea,function(t){return this.sub(c.copy(t).multiplyScalar(2*this.dot(t)))}),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(en.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,s=this.z-t.z;return e*e+i*i+s*s},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,i){var s=Math.sin(e)*t;return this.x=s*Math.sin(i),this.y=Math.cos(e)*t,this.z=s*Math.cos(i),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),s=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=s,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(eh.prototype,{isMatrix4:!0,set:function(t,e,i,s,r,n,o,a,h,c,l,u,d,p,f,y){var m=this.elements;return m[0]=t,m[4]=e,m[8]=i,m[12]=s,m[1]=r,m[5]=n,m[9]=o,m[13]=a,m[2]=h,m[6]=c,m[10]=l,m[14]=u,m[3]=d,m[7]=p,m[11]=f,m[15]=y,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new eh().fromArray(this.elements)},copy:function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:(l=new ea,function(t){var e=this.elements,i=t.elements,s=1/l.setFromMatrixColumn(t,0).length(),r=1/l.setFromMatrixColumn(t,1).length(),n=1/l.setFromMatrixColumn(t,2).length();return e[0]=i[0]*s,e[1]=i[1]*s,e[2]=i[2]*s,e[3]=0,e[4]=i[4]*r,e[5]=i[5]*r,e[6]=i[6]*r,e[7]=0,e[8]=i[8]*n,e[9]=i[9]*n,e[10]=i[10]*n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,i=t.x,s=t.y,r=t.z,n=Math.cos(i),o=Math.sin(i),a=Math.cos(s),h=Math.sin(s),c=Math.cos(r),l=Math.sin(r);if("XYZ"===t.order){var u=n*c,d=n*l,p=o*c,f=o*l;e[0]=a*c,e[4]=-a*l,e[8]=h,e[1]=d+p*h,e[5]=u-f*h,e[9]=-o*a,e[2]=f-u*h,e[6]=p+d*h,e[10]=n*a}else if("YXZ"===t.order){var y=a*c,m=a*l,g=h*c,v=h*l;e[0]=y+v*o,e[4]=g*o-m,e[8]=n*h,e[1]=n*l,e[5]=n*c,e[9]=-o,e[2]=m*o-g,e[6]=v+y*o,e[10]=n*a}else if("ZXY"===t.order){var y=a*c,m=a*l,g=h*c,v=h*l;e[0]=y-v*o,e[4]=-n*l,e[8]=g+m*o,e[1]=m+g*o,e[5]=n*c,e[9]=v-y*o,e[2]=-n*h,e[6]=o,e[10]=n*a}else if("ZYX"===t.order){var u=n*c,d=n*l,p=o*c,f=o*l;e[0]=a*c,e[4]=p*h-d,e[8]=u*h+f,e[1]=a*l,e[5]=f*h+u,e[9]=d*h-p,e[2]=-h,e[6]=o*a,e[10]=n*a}else if("YZX"===t.order){var x=n*a,b=n*h,z=o*a,_=o*h;e[0]=a*c,e[4]=_-x*l,e[8]=z*l+b,e[1]=l,e[5]=n*c,e[9]=-o*c,e[2]=-h*c,e[6]=b*l+z,e[10]=x-_*l}else if("XZY"===t.order){var x=n*a,b=n*h,z=o*a,_=o*h;e[0]=a*c,e[4]=-l,e[8]=h*c,e[1]=x*l+_,e[5]=n*c,e[9]=b*l-z,e[2]=z*l-b,e[6]=o*c,e[10]=_*l+x}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:(u=new ea(0,0,0),d=new ea(1,1,1),function(t){return this.compose(u,t,d)}),lookAt:(p=new ea,f=new ea,y=new ea,function(t,e,i){var s=this.elements;return y.subVectors(t,e),0===y.lengthSq()&&(y.z=1),y.normalize(),p.crossVectors(i,y),0===p.lengthSq()&&(1===Math.abs(i.z)?y.x+=1e-4:y.z+=1e-4,y.normalize(),p.crossVectors(i,y)),p.normalize(),f.crossVectors(y,p),s[0]=p.x,s[4]=f.x,s[8]=y.x,s[1]=p.y,s[5]=f.y,s[9]=y.y,s[2]=p.z,s[6]=f.z,s[10]=y.z,this}),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,s=e.elements,r=this.elements,n=i[0],o=i[4],a=i[8],h=i[12],c=i[1],l=i[5],u=i[9],d=i[13],p=i[2],f=i[6],y=i[10],m=i[14],g=i[3],v=i[7],x=i[11],b=i[15],z=s[0],_=s[4],w=s[8],M=s[12],E=s[1],O=s[5],A=s[9],S=s[13],P=s[2],T=s[6],j=s[10],C=s[14],B=s[3],R=s[7],V=s[11],I=s[15];return r[0]=n*z+o*E+a*P+h*B,r[4]=n*_+o*O+a*T+h*R,r[8]=n*w+o*A+a*j+h*V,r[12]=n*M+o*S+a*C+h*I,r[1]=c*z+l*E+u*P+d*B,r[5]=c*_+l*O+u*T+d*R,r[9]=c*w+l*A+u*j+d*V,r[13]=c*M+l*S+u*C+d*I,r[2]=p*z+f*E+y*P+m*B,r[6]=p*_+f*O+y*T+m*R,r[10]=p*w+f*A+y*j+m*V,r[14]=p*M+f*S+y*C+m*I,r[3]=g*z+v*E+x*P+b*B,r[7]=g*_+v*O+x*T+b*R,r[11]=g*w+v*A+x*j+b*V,r[15]=g*M+v*S+x*C+b*I,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:(m=new ea,function(t){for(var e=0,i=t.count;e<i;e++)m.x=t.getX(e),m.y=t.getY(e),m.z=t.getZ(e),m.applyMatrix4(this),t.setXYZ(e,m.x,m.y,m.z);return t}),determinant:function(){var t=this.elements,e=t[0],i=t[4],s=t[8],r=t[12],n=t[1],o=t[5],a=t[9],h=t[13],c=t[2],l=t[6],u=t[10],d=t[14];return t[3]*(+r*a*l-s*h*l-r*o*u+i*h*u+s*o*d-i*a*d)+t[7]*(+e*a*d-e*h*u+r*n*u-s*n*d+s*h*c-r*a*c)+t[11]*(+e*h*l-e*o*d-r*n*l+i*n*d+r*o*c-i*h*c)+t[15]*(-s*o*c-e*a*l+e*o*u+s*n*l-i*n*u+i*a*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,i){var s=this.elements;return t.isVector3?(s[12]=t.x,s[13]=t.y,s[14]=t.z):(s[12]=t,s[13]=e,s[14]=i),this},getInverse:function(t,e){var i=this.elements,s=t.elements,r=s[0],n=s[1],o=s[2],a=s[3],h=s[4],c=s[5],l=s[6],u=s[7],d=s[8],p=s[9],f=s[10],y=s[11],m=s[12],g=s[13],v=s[14],x=s[15],b=p*v*u-g*f*u+g*l*y-c*v*y-p*l*x+c*f*x,z=m*f*u-d*v*u-m*l*y+h*v*y+d*l*x-h*f*x,_=d*g*u-m*p*u+m*c*y-h*g*y-d*c*x+h*p*x,w=m*p*l-d*g*l-m*c*f+h*g*f+d*c*v-h*p*v,M=r*b+n*z+o*_+a*w;if(0===M){var E="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw Error(E);return console.warn(E),this.identity()}var O=1/M;return i[0]=b*O,i[1]=(g*f*a-p*v*a-g*o*y+n*v*y+p*o*x-n*f*x)*O,i[2]=(c*v*a-g*l*a+g*o*u-n*v*u-c*o*x+n*l*x)*O,i[3]=(p*l*a-c*f*a-p*o*u+n*f*u+c*o*y-n*l*y)*O,i[4]=z*O,i[5]=(d*v*a-m*f*a+m*o*y-r*v*y-d*o*x+r*f*x)*O,i[6]=(m*l*a-h*v*a-m*o*u+r*v*u+h*o*x-r*l*x)*O,i[7]=(h*f*a-d*l*a+d*o*u-r*f*u-h*o*y+r*l*y)*O,i[8]=_*O,i[9]=(m*p*a-d*g*a-m*n*y+r*g*y+d*n*x-r*p*x)*O,i[10]=(h*g*a-m*c*a+m*n*u-r*g*u-h*n*x+r*c*x)*O,i[11]=(d*c*a-h*p*a-d*n*u+r*p*u+h*n*y-r*c*y)*O,i[12]=w*O,i[13]=(d*g*o-m*p*o+m*n*f-r*g*f-d*n*v+r*p*v)*O,i[14]=(m*c*o-h*g*o-m*n*l+r*g*l+h*n*v-r*c*v)*O,i[15]=(h*p*o-d*c*o+d*n*l-r*p*l-h*n*f+r*c*f)*O,this},scale:function(t){var e=this.elements,i=t.x,s=t.y,r=t.z;return e[0]*=i,e[4]*=s,e[8]*=r,e[1]*=i,e[5]*=s,e[9]*=r,e[2]*=i,e[6]*=s,e[10]*=r,e[3]*=i,e[7]*=s,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),s=Math.sin(e),r=1-i,n=t.x,o=t.y,a=t.z,h=r*n,c=r*o;return this.set(h*n+i,h*o-s*a,h*a+s*o,0,h*o+s*a,c*o+i,c*a-s*n,0,h*a-s*o,c*a+s*n,r*a*a+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,e,i){return this.set(1,e,i,0,t,1,i,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,i){var s=this.elements,r=e._x,n=e._y,o=e._z,a=e._w,h=r+r,c=n+n,l=o+o,u=r*h,d=r*c,p=r*l,f=n*c,y=n*l,m=o*l,g=a*h,v=a*c,x=a*l,b=i.x,z=i.y,_=i.z;return s[0]=(1-(f+m))*b,s[1]=(d+x)*b,s[2]=(p-v)*b,s[3]=0,s[4]=(d-x)*z,s[5]=(1-(u+m))*z,s[6]=(y+g)*z,s[7]=0,s[8]=(p+v)*_,s[9]=(y-g)*_,s[10]=(1-(u+f))*_,s[11]=0,s[12]=t.x,s[13]=t.y,s[14]=t.z,s[15]=1,this},decompose:(g=new ea,v=new eh,function(t,e,i){var s=this.elements,r=g.set(s[0],s[1],s[2]).length(),n=g.set(s[4],s[5],s[6]).length(),o=g.set(s[8],s[9],s[10]).length();0>this.determinant()&&(r=-r),t.x=s[12],t.y=s[13],t.z=s[14],v.copy(this);var a=1/r,h=1/n,c=1/o;return v.elements[0]*=a,v.elements[1]*=a,v.elements[2]*=a,v.elements[4]*=h,v.elements[5]*=h,v.elements[6]*=h,v.elements[8]*=c,v.elements[9]*=c,v.elements[10]*=c,e.setFromRotationMatrix(v),i.x=r,i.y=n,i.z=o,this}),makePerspective:function(t,e,i,s,r,n){void 0===n&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements;return o[0]=2*r/(e-t),o[4]=0,o[8]=(e+t)/(e-t),o[12]=0,o[1]=0,o[5]=2*r/(i-s),o[9]=(i+s)/(i-s),o[13]=0,o[2]=0,o[6]=0,o[10]=-(n+r)/(n-r),o[14]=-2*n*r/(n-r),o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,i,s,r,n){var o=this.elements,a=1/(e-t),h=1/(i-s),c=1/(n-r);return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-((e+t)*a),o[1]=0,o[5]=2*h,o[9]=0,o[13]=-((i+s)*h),o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-((n+r)*c),o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,i=t.elements,s=0;s<16;s++)if(e[s]!==i[s])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<16;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}),ec.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ec.DefaultOrder="XYZ",Object.defineProperties(ec.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(ec.prototype,{isEuler:!0,set:function(t,e,i,s){return this._x=t,this._y=e,this._z=i,this._order=s||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var s=en.clamp,r=t.elements,n=r[0],o=r[4],a=r[8],h=r[1],c=r[5],l=r[9],u=r[2],d=r[6],p=r[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(s(a,-1,1)),.99999>Math.abs(a)?(this._x=Math.atan2(-l,p),this._z=Math.atan2(-o,n)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-s(l,-1,1)),.99999>Math.abs(l)?(this._y=Math.atan2(a,p),this._z=Math.atan2(h,c)):(this._y=Math.atan2(-u,n),this._z=0)):"ZXY"===e?(this._x=Math.asin(s(d,-1,1)),.99999>Math.abs(d)?(this._y=Math.atan2(-u,p),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(h,n))):"ZYX"===e?(this._y=Math.asin(-s(u,-1,1)),.99999>Math.abs(u)?(this._x=Math.atan2(d,p),this._z=Math.atan2(h,n)):(this._x=0,this._z=Math.atan2(-o,c))):"YZX"===e?(this._z=Math.asin(s(h,-1,1)),.99999>Math.abs(h)?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-u,n)):(this._x=0,this._y=Math.atan2(a,p))):"XZY"===e?(this._z=Math.asin(-s(o,-1,1)),.99999>Math.abs(o)?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-l,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==i&&this._onChangeCallback(),this},setFromQuaternion:(x=new eh,function(t,e,i){return x.makeRotationFromQuaternion(t),this.setFromRotationMatrix(x,e,i)}),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:(b=new eo,function(t){return b.setFromEuler(this),this.setFromQuaternion(b,t)}),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new ea(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var el={toScreenPos:(z=new ea,function(t,e,i){return z.copy(t),z.project(e),z.x=Math.round((z.x+1)*i.width/2),z.y=Math.round((-z.y+1)*i.height/2),z.z=0,z}),toSpacePos:(w=new ea,M=new ea,function(t,e,i){return w.set(t.x/i.width*2-1,-(2*(t.y/i.height))+1,.5),w.unproject(e),M.copy(w.sub(e.position).normalize()),_=-e.position.z/M.z,w.copy(e.position),w.add(M.multiplyScalar(_)),w})},eu={initValue:function(t,e){return null!=t&&void 0!=t?t:e},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},destroyArray:function(t){t.length=0},destroyObject:function(t){for(var e in t)delete t[e]},isUndefined:function(){for(var t in arguments){var e=arguments[t];if(void 0!==e)return!1}return!0},setVectorByObj:function(t,e){void 0!==e.x&&(t.position.x=e.x),void 0!==e.y&&(t.position.y=e.y),void 0!==e.z&&(t.position.z=e.z),void 0!==e.vx&&(t.velocity.x=e.vx),void 0!==e.vy&&(t.velocity.y=e.vy),void 0!==e.vz&&(t.velocity.z=e.vz),void 0!==e.ax&&(t.acceleration.x=e.ax),void 0!==e.ay&&(t.acceleration.y=e.ay),void 0!==e.az&&(t.acceleration.z=e.az),void 0!==e.p&&t.position.copy(e.p),void 0!==e.v&&t.velocity.copy(e.v),void 0!==e.a&&t.acceleration.copy(e.a),void 0!==e.position&&t.position.copy(e.position),void 0!==e.velocity&&t.velocity.copy(e.velocity),void 0!==e.accelerate&&t.acceleration.copy(e.accelerate)},setPrototypeByObj:function(t,e,i){for(var s in e)t.hasOwnProperty(s)&&(i?0>i.indexOf(s)&&(t[s]=this._getValue(e[s])):t[s]=this._getValue(e[s]));return t},_getValue:function(t){return"Span"===t.constructor.type?t.getValue():t}},ed={},ep="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(ep){var ef=new Uint8Array(16);ed=function(){return ep(ef),ef}}else{var ey=Array(16);ed=function(){for(var t,e=0;e<16;e++)(3&e)==0&&(t=4294967296*Math.random()),ey[e]=t>>>((3&e)<<3)&255;return ey}}for(var em={},eg=[],ev=0;ev<256;++ev)eg[ev]=(ev+256).toString(16).substr(1);em=function(t,e){var i=e||0;return[eg[t[i++]],eg[t[i++]],eg[t[i++]],eg[t[i++]],"-",eg[t[i++]],eg[t[i++]],"-",eg[t[i++]],eg[t[i++]],"-",eg[t[i++]],eg[t[i++]],"-",eg[t[i++]],eg[t[i++]],eg[t[i++]],eg[t[i++]],eg[t[i++]],eg[t[i++]]].join("")};var ex=0,eb=0,ez=N(function(t,e,i){var s=e&&i||0,r=e||[],n=(t=t||{}).node||Z,o=void 0!==t.clockseq?t.clockseq:q;if(null==n||null==o){var a=ed();null==n&&(n=Z=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==o&&(o=q=(a[6]<<8|a[7])&16383)}var h=void 0!==t.msecs?t.msecs:new Date().getTime(),c=void 0!==t.nsecs?t.nsecs:eb+1,l=h-ex+(c-eb)/1e4;if(l<0&&void 0===t.clockseq&&(o=o+1&16383),(l<0||h>ex)&&void 0===t.nsecs&&(c=0),c>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");ex=h,eb=c,q=o;var u=((268435455&(h+=122192928e5))*1e4+c)%4294967296;r[s++]=u>>>24&255,r[s++]=u>>>16&255,r[s++]=u>>>8&255,r[s++]=255&u;var d=h/4294967296*1e4&268435455;r[s++]=d>>>8&255,r[s++]=255&d,r[s++]=d>>>24&15|16,r[s++]=d>>>16&255,r[s++]=o>>>8|128,r[s++]=255&o;for(var p=0;p<6;++p)r[s+p]=n[p];return e||em(r)});function e_(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function ew(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?e_(Object(i),!0).forEach(function(e){N(ei)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e_(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}const eM=(t,e)=>ew(ew({},t),e);var eE={randomAToB:function(t,e,i){return i?(Math.random()*(e-t)>>0)+t:t+Math.random()*(e-t)},randomFloating:function(t,e,i){return this.randomAToB(t-e,t+e,i)},randomZone:function(t){},degreeTransform:function(t){return 3.142*t/180},toColor16:function(t){return"#"+t.toString(16)},randomColor:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)},lerp:function(t,e,i){return e+(t-e)*i},getNormal:function(t,e){return 0==t.x&&0==t.y?0==t.z?e.set(1,0,1):e.set(1,1,-t.y/t.z):0==t.x?e.set(1,0,1):e.set(-t.y/t.x,1,1),e.normalize()},axisRotate:function(t,e,i,s){var r=Math.cos(s),n=Math.sin(s),o=i.dot(e)*(1-r);t.copy(i),t.cross(e).scalar(n),t.addValue(e.x*r,e.y*r,e.z*r),t.addValue(i.x*o,i.y*o,i.z*o)}};class eO{constructor(t,e,i){this._isArray=!1,this.type="Span",eu.isArray(t)?(this._isArray=!0,this.a=t):(this.a=eu.initValue(t,1),this.b=eu.initValue(e,this.a),this._center=eu.initValue(i,!1))}getValue(t){return this._isArray?this.a[this.a.length*Math.random()>>0]:this._center?eE.randomFloating(this.a,this.b,t):eE.randomAToB(this.a,this.b,t)}}const eA=(t,e,i)=>t instanceof eO?t:void 0===e?new eO(t):void 0===i?new eO(t,e):new eO(t,e,i);var eS={},eP={},eT={},ej=Math.floor,eC=Math.random;eT=function(t,e){return t+ej(eC()*(e-t+1))},eP=function(t){var e=t.length;return e?t[eT(0,e-1)]:void 0};var eB={},eR={},eV={},eI={};eI=function(t,e){for(var i=-1,s=null==t?0:t.length,r=Array(s);++i<s;)r[i]=e(t[i],i,t);return r},eV=function(t,e){return eI(e,function(e){return t[e]})};var eF={},eD={},ek={};ek=function(t,e){for(var i=-1,s=Array(t);++i<t;)s[i]=e(i);return s};var eZ={},eq={},eL={},eN={};eN=Y("23YZo").Symbol;var eU={},eJ=Object.prototype,eQ=eJ.hasOwnProperty,eY=eJ.toString,eX=eN?eN.toStringTag:void 0;eU=function(t){var e=eQ.call(t,eX),i=t[eX];try{t[eX]=void 0;var s=!0}catch(t){}var r=eY.call(t);return s&&(e?t[eX]=i:delete t[eX]),r};var eH={},eG=Object.prototype.toString;eH=function(t){return eG.call(t)};var eW=eN?eN.toStringTag:void 0;eL=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":eW&&eW in Object(t)?eU(t):eH(t)};var e$={};e$=function(t){return null!=t&&"object"==typeof t},eq=function(t){return e$(t)&&"[object Arguments]"==eL(t)};var eK=Object.prototype,e1=eK.hasOwnProperty,e0=eK.propertyIsEnumerable;eZ=eq(function(){return arguments}())?eq:function(t){return e$(t)&&e1.call(t,"callee")&&!e0.call(t,"callee")};var e2={};e2=Array.isArray;var e5=Y("f504n"),e4={},e3=/^(?:0|[1-9]\d*)$/;e4=function(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&e3.test(t))&&t>-1&&t%1==0&&t<e};var e9={},e8={},e6={};e6=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var e7={};e7["[object Float32Array]"]=e7["[object Float64Array]"]=e7["[object Int8Array]"]=e7["[object Int16Array]"]=e7["[object Int32Array]"]=e7["[object Uint8Array]"]=e7["[object Uint8ClampedArray]"]=e7["[object Uint16Array]"]=e7["[object Uint32Array]"]=!0,e7["[object Arguments]"]=e7["[object Array]"]=e7["[object ArrayBuffer]"]=e7["[object Boolean]"]=e7["[object DataView]"]=e7["[object Date]"]=e7["[object Error]"]=e7["[object Function]"]=e7["[object Map]"]=e7["[object Number]"]=e7["[object Object]"]=e7["[object RegExp]"]=e7["[object Set]"]=e7["[object String]"]=e7["[object WeakMap]"]=!1,e8=function(t){return e$(t)&&e6(t.length)&&!!e7[eL(t)]};var it={};it=function(t){return function(e){return t(e)}};var ie=Y("jIny1"),ii=ie&&ie.isTypedArray;e9=ii?it(ii):e8;var is=Object.prototype.hasOwnProperty;eD=function(t,e){var i=e2(t),s=!i&&eZ(t),r=!i&&!s&&e5(t),n=!i&&!s&&!r&&e9(t),o=i||s||r||n,a=o?ek(t.length,String):[],h=a.length;for(var c in t)(e||is.call(t,c))&&!(o&&("length"==c||r&&("offset"==c||"parent"==c)||n&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||e4(c,h)))&&a.push(c);return a};var ir={},io={},ia=Object.prototype;io=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ia)};var ih={};r=Object.keys,n=Object,ih=function(t){return r(n(t))};var ic=Object.prototype.hasOwnProperty;ir=function(t){if(!io(t))return ih(t);var e=[];for(var i in Object(t))ic.call(t,i)&&"constructor"!=i&&e.push(i);return e};var il={},iu={},id={};id=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},iu=function(t){if(!id(t))return!1;var e=eL(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},il=function(t){return null!=t&&e6(t.length)&&!iu(t)},eF=function(t){return il(t)?eD(t):ir(t)},eR=function(t){return null==t?[]:eV(t,eF(t))},eB=function(t){return eP(eR(t))},eS=function(t){return(e2(t)?eP:eB)(t)};class ip extends eO{constructor(t){super(),this.type="ArraySpan",this.items=Array.isArray(t)?t:[t]}getValue(){return N(eS)(this.items)}}const iy=t=>t?t instanceof ip?t:new ip(t):null;class im extends eO{constructor(t){super(),this.type="ColorSpan",this.shouldRandomize="random"===t,this.colors=Array.isArray(t)?t:[t]}getValue(){return this.shouldRandomize?eE.randomColor():N(eS)(this.colors)}}const ig=t=>(t||(console.warn(`Invalid colors argument ${t} passed to createColorSpan. Defaulting to 'random'.`),t="random"),t instanceof im)?t:new im(t),iv="EULER",ix=(t,e,i)=>{t.sleep||(t.old.position.copy(t.position),t.old.velocity.copy(t.velocity),t.acceleration.scalar(1/t.mass),t.velocity.add(t.acceleration.scalar(e)),t.position.add(t.old.velocity.scalar(e)),i&&t.velocity.scalar(Math.pow(i,e/.0167)),t.acceleration.clear())},ib=(t,e,i,s=iv)=>{ix(t,e,i)};class iz extends ea{clear(){return this.x=0,this.y=0,this.z=0,this}scalar(t){return this.x*=t,this.y*=t,this.z*=t,this}addValue(t,e,i){return this.x+=t,this.y+=e,this.z+=i,this}toString(){return"x:"+this.x+"y:"+this.y+"z:"+this.z}eulerFromDir(t){return new ec().setFromVector3(t)}}class i_{constructor(t,e,i){this.type="Polar3D",this.radius=t||1,this.phi=i||0,this.theta=e||0}set(t,e,i){return this.radius=t||1,this.phi=i||0,this.theta=e||0,this}setRadius(t){return this.radius=t,this}setPhi(t){return this.phi=t,this}setTheta(t){return this.theta=t,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}toVector3D(){return new iz(this.getX(),this.getY(),this.getZ())}getX(){return this.radius*Math.sin(this.theta)*Math.cos(this.phi)}getY(){return-this.radius*Math.sin(this.theta)*Math.sin(this.phi)}getZ(){return this.radius*Math.cos(this.theta)}normalize(){return this.radius=1,this}equals(t){return t.radius===this.radius&&t.phi===this.phi&&t.theta===this.theta}clear(){return this.radius=0,this.phi=0,this.theta=0,this}clone(){return new i_(this.radius,this.phi,this.theta)}}class iw{constructor(t){this.id=`particle-${ez()}`,this.type="Particle",this.life=t6,this.age=0,this.energy=1,this.dead=!1,this.sleep=!1,this.body=null,this.parent=null,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.useColor=!1,this.useAlpha=!1,this.easing=tk,this.position=new iz,this.velocity=new iz,this.acceleration=new iz,this.old={},this.old.position=this.position.clone(),this.old.velocity=this.velocity.clone(),this.old.acceleration=this.acceleration.clone(),this.behaviours=[],this.transform={},this.color={r:0,g:0,b:0},this.rotation=new iz,this.distanceToCamera=0,eu.setPrototypeByObj(this,t)}getDirection(){return 57.28835136855506*Math.atan2(this.velocity.x,-this.velocity.y)}reset(){return this.life=t6,this.age=0,this.energy=1,this.dead=!1,this.sleep=!1,this.body=null,this.parent=null,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.useColor=!1,this.useAlpha=!1,this.easing=tk,this.position.set(0,0,0),this.velocity.set(0,0,0),this.acceleration.set(0,0,0),this.old.position.set(0,0,0),this.old.velocity.set(0,0,0),this.old.acceleration.set(0,0,0),this.color.r=0,this.color.g=0,this.color.b=0,this.rotation.clear(),eu.destroyObject(this.transform),this.removeAllBehaviours(),this}update(t,e){if(!this.sleep){this.age+=t;let i=this.behaviours.length;for(;i--;)this.behaviours[i].applyBehaviour(this,t,e)}if(this.age>=this.life)this.destroy();else{let t=this.easing(this.age/this.life);this.energy=Math.max(1-t,0)}}addBehaviour(t){this.behaviours.push(t),t.initialize(this)}addBehaviours(t){let e=t.length;for(;e--;)this.addBehaviour(t[e])}removeBehaviour(t){let e=this.behaviours.indexOf(t);e>-1&&this.behaviours.splice(e,1)}removeAllBehaviours(){eu.destroyArray(this.behaviours)}destroy(){this.removeAllBehaviours(),this.energy=0,this.dead=!0,this.parent=null}}class iM{constructor(){this.type="Pool",this.cID=0,this.list={}}create(t,...e){if(!this.canCreateNewObject(t))throw Error("The pool is unable to create or clone the object supplied");return(this.cID++,this.canInstantiateObject(t))?new t(...e):this.canCloneObject(t)?t.clone():void 0}canInstantiateObject(t){return"function"==typeof t}canCloneObject(t){return t.clone&&"function"==typeof t.clone}canCreateNewObject(t){return!!(this.canInstantiateObject(t)||this.canCloneObject(t))}getCount(){var t=0;for(var e in this.list)t+=this.list[e].length;return t++}get(t,...e){var i,s=t.__puid||er.id(t);return(i=this.list[s]&&this.list[s].length>0?this.list[s].pop():this.create(t,...e)).__puid=t.__puid||s,i}expire(t){return this._getList(t.__puid).push(t)}destroy(){for(var t in this.list)this.list[t].length=0,delete this.list[t]}_getList(t){return t=t||"default",this.list[t]||(this.list[t]=[]),this.list[t]}}const iE="SYSTEM_UPDATE",iO="PARTICLE_CREATED",iA="PARTICLE_UPDATE",iS="PARTICLE_DEAD",iP="EMITTER_DEAD";var iT=class{constructor(){this.listeners=null}set listeners(t){this._listeners=t}get listeners(){return this._listeners}addEventListener(t,e){return this.listeners?this.removeEventListener(t,e):this.listeners={},this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e),e}removeEventListener(t,e){if(this.listeners&&this.listeners[t]){for(var i=this.listeners[t],s=0,r=i.length;s<r;s++)if(i[s]==e){1==r?delete this.listeners[t]:i.splice(s,1);break}}}removeAllEventListeners(t){t?this.listeners&&delete this.listeners[t]:this.listeners=null}dispatchEvent(t,e){var i=!1,s=this.listeners;if(t&&s){var r=s[t];if(!r)return i;for(var n,o=(r=r.slice()).length;o--;)n=r[o],i=i||n(e)}return!!i}hasEventListener(t){var e=this.listeners;return!!(e&&e[t])}},ij={};U(ij,"Body",()=>iB),U(ij,"BodySprite",()=>iq),U(ij,"InitializerUtil",()=>iN),U(ij,"Life",()=>iU),U(ij,"Mass",()=>iJ),U(ij,"Position",()=>i5),U(ij,"Radius",()=>i4),U(ij,"Rate",()=>i3),U(ij,"Texture",()=>i6),U(ij,"VectorVelocity",()=>si),U(ij,"PolarVelocity",()=>st),U(ij,"RadialVelocity",()=>se);class iC{constructor(t="Initializer",e=!0){this.type=t,this.isEnabled=e}init(t,e){this.isEnabled&&(e?(this.initialize(e),e.hasBeenInitialized=!0):(this.initialize(t),t.hasBeenInitialized=!0))}reset(){}initialize(t){}static requiresWebGlApi(){return!1}static fromJSON(t){}}class iB extends iC{constructor(t,e,i,s=!0){super(ta,s),this.body=iy(t),this.w=e,this.h=i||e}initialize(t){var e=this.body.getValue();this.w?t.body={width:this.w,height:this.h,body:e}:t.body=e}static fromJSON(t){let{body:e,width:i,height:s,isEnabled:r=!0}=t;return new iB(e,i,s,r)}}function iR(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function iV(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?iR(Object(i),!0).forEach(function(e){N(ei)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):iR(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}const iI={AdditiveBlending:2,CustomBlending:5,MultiplyBlending:4,NoBlending:0,NormalBlending:1,SubtractiveBlending:3},iF={color:16711680,blending:2,fog:!0},iD=iV(iV({},iF),{},{blending:"AdditiveBlending"});function ik(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function iZ(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ik(Object(i),!0).forEach(function(e){N(ei)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ik(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}class iq extends iC{constructor(t,e,i=iF,s=!0){super(th,s);let{Sprite:r,SpriteMaterial:n,TextureLoader:o}=t;this.materialProperties=eM(iF,i),new o().load(e,t=>{this.texture=t,this.material=new n(iZ(iZ({},{map:t}),this.materialProperties)),this.sprite=new r(this.material)},void 0,t=>{throw Error(t)})}initialize(t){t.body=this.sprite}static fromJSON(t,e){let{texture:i,materialProperties:s=iD,isEnabled:r=!0}=t;return new iq(e,i,eM(iD,(t=>{let{blending:e}=t;return iZ(iZ({},t),{},{blending:e?iI[e]:iI[iD.blending]})})(s)),r)}}const iL=new ec;var iN={particleEuler:null,initialize:function(t,e,i){let s=i.length;for(;s--;)i[s].init(t,e);t.bindEmitter&&this.bindEmitter(t,e)},bindEmitter:function(t,e){let{rotation:{x:i,y:s,z:r}}=t;e.position.add(t.position),e.velocity.add(t.velocity),e.acceleration.add(t.acceleration),e.velocity.applyEuler(iL.set(i,s,r))}};class iU extends iC{constructor(t,e,i,s=!0){super(tl,s),this.lifePan=eA(t,e,i)}initialize(t){this.lifePan.a==1/0||"infi"==this.lifePan.a?t.life=1/0:t.life=this.lifePan.getValue()}static fromJSON(t){let{min:e,max:i,center:s=!1,isEnabled:r=!0}=t;return new iU(e,i,s,r)}}class iJ extends iC{constructor(t,e,i=!1,s=!0){super(tu,s),this.massPan=eA(t,e,i)}initialize(t){t.mass=this.massPan.getValue()}static fromJSON(t){let{min:e,max:i,center:s=!1,isEnabled:r=!0}=t;return new iJ(e,i,s,r)}}var iQ={},iY={};(iY=function(t,e){if(null==t)return{};var i,s,r={},n=Object.keys(t);for(s=0;s<n.length;s++)i=n[s],e.indexOf(i)>=0||(r[i]=t[i]);return r}).__esModule=!0,iY.default=iY,(iQ=function(t,e){if(null==t)return{};var i,s,r=iY(t,e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}).__esModule=!0,iQ.default=iQ;var iX={};U(iX,"BoxZone",()=>iG),U(iX,"LineZone",()=>iW),U(iX,"MeshZone",()=>i$),U(iX,"PointZone",()=>iK),U(iX,"ScreenZone",()=>i1),U(iX,"SphereZone",()=>i0);class iH{constructor(t="Zone"){this.type=t,this.vector=new iz(0,0,0),this.random=0,this.crossType="dead",this.log=!0,this.supportsCrossing=!0}getPosition(){return null}crossing(t){if(!this.supportsCrossing)return console.warn(`${this.constructor.name} does not support the crossing method`);switch(this.crossType){case"bound":this._bound(t);break;case"cross":this._cross(t);break;case"dead":this._dead(t)}}isBoxZone(){return!1}isLineZone(){return!1}isMeshZone(){return!1}isPointZone(){return!1}isScreenZone(){return!1}isSphereZone(){return!1}_dead(t){}_bound(t){}_cross(t){}}class iG extends iH{constructor(t,e,i,s,r,n){var o,a,h,c,l;super(tv),eu.isUndefined(e,i,s,r,n)?(o=a=h=0,c=l=s=t||100):eu.isUndefined(s,r,n)?(o=a=h=0,c=t,l=e,s=i):(o=t,a=e,h=i,c=s,l=r,s=n),this.x=o,this.y=a,this.z=h,this.width=c,this.height=l,this.depth=s,this.friction=.85,this.max=6}isBoxZone(){return!0}getPosition(){return this.vector.x=this.x+eE.randomAToB(-.5,.5)*this.width,this.vector.y=this.y+eE.randomAToB(-.5,.5)*this.height,this.vector.z=this.z+eE.randomAToB(-.5,.5)*this.depth,this.vector}_dead(t){t.position.x+t.radius<this.x-this.width/2?t.dead=!0:t.position.x-t.radius>this.x+this.width/2&&(t.dead=!0),t.position.y+t.radius<this.y-this.height/2?t.dead=!0:t.position.y-t.radius>this.y+this.height/2&&(t.dead=!0),t.position.z+t.radius<this.z-this.depth/2?t.dead=!0:t.position.z-t.radius>this.z+this.depth/2&&(t.dead=!0)}_bound(t){t.position.x-t.radius<this.x-this.width/2?(t.position.x=this.x-this.width/2+t.radius,t.velocity.x*=-this.friction,this._static(t,"x")):t.position.x+t.radius>this.x+this.width/2&&(t.position.x=this.x+this.width/2-t.radius,t.velocity.x*=-this.friction,this._static(t,"x")),t.position.y-t.radius<this.y-this.height/2?(t.position.y=this.y-this.height/2+t.radius,t.velocity.y*=-this.friction,this._static(t,"y")):t.position.y+t.radius>this.y+this.height/2&&(t.position.y=this.y+this.height/2-t.radius,t.velocity.y*=-this.friction,this._static(t,"y")),t.position.z-t.radius<this.z-this.depth/2?(t.position.z=this.z-this.depth/2+t.radius,t.velocity.z*=-this.friction,this._static(t,"z")):t.position.z+t.radius>this.z+this.depth/2&&(t.position.z=this.z+this.depth/2-t.radius,t.velocity.z*=-this.friction,this._static(t,"z"))}_static(t,e){!(t.velocity[e]*t.acceleration[e]>0)&&Math.abs(t.velocity[e])<.0167*Math.abs(t.acceleration[e])*this.max&&(t.velocity[e]=0,t.acceleration[e]=0)}_cross(t){t.position.x+t.radius<this.x-this.width/2&&t.velocity.x<=0?t.position.x=this.x+this.width/2+t.radius:t.position.x-t.radius>this.x+this.width/2&&t.velocity.x>=0&&(t.position.x=this.x-this.width/2-t.radius),t.position.y+t.radius<this.y-this.height/2&&t.velocity.y<=0?t.position.y=this.y+this.height/2+t.radius:t.position.y-t.radius>this.y+this.height/2&&t.velocity.y>=0&&(t.position.y=this.y-this.height/2-t.radius),t.position.z+t.radius<this.z-this.depth/2&&t.velocity.z<=0?t.position.z=this.z+this.depth/2+t.radius:t.position.z-t.radius>this.z+this.depth/2&&t.velocity.z>=0&&(t.position.z=this.z-this.depth/2-t.radius)}}class iW extends iH{constructor(t,e,i,s,r,n){super(tx),t instanceof iz?(this.x1=t.x,this.y1=t.y,this.z1=t.z,this.x2=s.x,this.y2=s.y,this.z2=s.z):(this.x1=t,this.y1=e,this.z1=i,this.x2=s,this.y2=r,this.z2=n),this.supportsCrossing=!1}isLineZone(){return!0}getPosition(){return this.random=Math.random(),this.vector.x=this.x1+this.random*(this.x2-this.x1),this.vector.y=this.y1+this.random*(this.y2-this.y1),this.vector.z=this.z1+this.random*(this.z2-this.z1),this.vector}}class i$ extends iH{constructor(t,e=1,i){if(super(tb),this.geometry=null,this.scale=e,this.supportsCrossing=!1,t.type&&"Geometry"===t.type&&(this.geometry=t),t.geometry&&(this.geometry=t.geometry),!this.geometry)throw Error("MeshZone unable to set geometry from the supplied bounds");this.geometry.isBufferGeometry&&(this.geometry=new i().fromBufferGeometry(this.geometry))}isMeshZone(){return!0}getPosition(){let t=this.geometry.vertices,e=t[t.length*Math.random()>>0];return this.vector.x=e.x*this.scale,this.vector.y=e.y*this.scale,this.vector.z=e.z*this.scale,this.vector}}class iK extends iH{constructor(t,e,i){var s;super(tz),s=eu.isUndefined(t,e,i)?0:t,this.x=s,this.y=s,this.z=s,this.supportsCrossing=!1}isPointZone(){return!0}getPosition(){return this.vector.x=this.x,this.vector.y=this.y,this.vector.z=this.z,this.vector}}class i1 extends iH{constructor(t,e,i,s){super("ScreenZone"),this.camera=t,this.renderer=e,this.dis=i||20,s=s||"1234";for(var r=1;r<5;r++)this["d"+r]=s.indexOf(r+"")>=0}isScreenZone(){return!0}_dead(t){var e=el.toScreenPos(t.position,this.camera,this.renderer.domElement),i=this.renderer.domElement;e.y+t.radius<-this.dis&&this.d1?t.dead=!0:e.y-t.radius>i.height+this.dis&&this.d3&&(t.dead=!0),e.x+t.radius<-this.dis&&this.d4?t.dead=!0:e.x-t.radius>i.width+this.dis&&this.d2&&(t.dead=!0)}_bound(t){var e=el.toScreenPos(t.position,this.camera,this.renderer.domElement),i=this.renderer.domElement;e.y+t.radius<-this.dis?t.velocity.y*=-1:e.y-t.radius>i.height+this.dis&&(t.velocity.y*=-1),e.x+t.radius<-this.dis?t.velocity.y*=-1:e.x-t.radius>i.width+this.dis&&(t.velocity.y*=-1)}}i1.prototype.getPosition=(O=new iz,function(){return E=this.renderer.domElement,O.x=Math.random()*E.width,O.y=Math.random()*E.height,this.vector.copy(el.toSpacePos(O,this.camera,E)),this.vector}),i1.prototype._cross=(A=new iz,function(t){var e=el.toScreenPos(t.position,this.camera,this.renderer.domElement),i=this.renderer.domElement;e.y+t.radius<-this.dis?(A.x=e.x,A.y=i.height+this.dis+t.radius,t.position.y=el.toSpacePos(A,this.camera,i).y):e.y-t.radius>i.height+this.dis&&(A.x=e.x,A.y=-this.dis-t.radius,t.position.y=el.toSpacePos(A,this.camera,i).y),e.x+t.radius<-this.dis?(A.y=e.y,A.x=i.width+this.dis+t.radius,t.position.x=el.toSpacePos(A,this.camera,i).x):e.x-t.radius>i.width+this.dis&&(A.y=e.y,A.x=-this.dis-t.radius,t.position.x=el.toSpacePos(A,this.camera,i).x)});class i0 extends iH{constructor(t,e,i,s){let r,n;super(t_),eu.isUndefined(e,i,s)?(r=0,n=t||100):(r=t,n=s),this.x=r,this.y=r,this.z=r,this.radius=n,this.the=this.phi=0}isSphereZone(){return!0}_dead(t){t.position.distanceTo(this)-t.radius>this.radius&&(t.dead=!0)}_cross(){console.warn(`${this.constructor.name} does not support the _cross method`)}}i0.prototype.getPosition=function(){return this.random=Math.random(),T=this.random*this.radius,S=3.142*Math.random(),P=6.284*Math.random(),this.vector.x=this.x+T*Math.sin(S)*Math.cos(P),this.vector.y=this.y+T*Math.sin(P)*Math.sin(S),this.vector.z=this.z+T*Math.cos(S),this.vector},i0.prototype._bound=(C=new iz,B=new iz,function(t){t.position.distanceTo(this)+t.radius>=this.radius&&(C.copy(t.position).sub(this).normalize(),B.copy(t.velocity),j=2*B.dot(C),t.velocity.sub(C.scalar(j)))});const i2=["zoneType"];class i5 extends iC{constructor(){super(td),this.reset.apply(this,arguments)}reset(){this.zones?this.zones.length=0:this.zones=[],this.zones=this.zones.concat(Array.prototype.slice.call(arguments))}addZone(){this.zones=this.zones.concat(Array.prototype.slice.call(arguments))}static fromJSON(t){let{zoneType:e}=t,i=N(iQ)(t,i2);if(!ee.includes(e))throw Error(`The zone type ${e} is invalid or not yet supported`);return new i5(new iX[e](...Object.values(i)))}}i5.prototype.initialize=function(t){(s=this.zones[Math.random()*this.zones.length>>0]).getPosition(),t.position.x=s.vector.x,t.position.y=s.vector.y,t.position.z=s.vector.z};class i4 extends iC{constructor(t,e,i=!1,s=!0){super(tp,s),this.radius=eA(t,e,i)}reset(t,e,i=!1){this.radius=eA(t,e,i)}initialize(t){t.radius=this.radius.getValue(),t.transform.oldRadius=t.radius}static fromJSON(t){let{width:e,height:i,center:s=!1,isEnabled:r=!0}=t;return new i4(e,i,s,r)}}class i3 extends iC{constructor(t=1,e=1){super("Rate"),this.numPan=eA(t),this.timePan=eA(e),this.startTime=0,this.nextTime=0,this.init()}init(){this.startTime=0,this.nextTime=this.timePan.getValue()}getValue(t){if(this.startTime+=t,this.startTime>=this.nextTime){if(this.init(),1!=this.numPan.b)return this.numPan.getValue("Int");if(this.numPan.getValue("Float")>.5)return 1}return 0}static fromJSON(t){let{particlesMin:e,particlesMax:i,perSecondMin:s,perSecondMax:r}=t;return new i3(new eO(e,i),new eO(s,r))}}function i9(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function i8(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?i9(Object(i),!0).forEach(function(e){N(ei)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):i9(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}class i6 extends iC{constructor(t,e,i=iF,s=!0){super(tc,s);let{Sprite:r,SpriteMaterial:n}=t;this.materialProperties=eM(iF,i),this.texture=e,this.material=new n(i8(i8({},{map:e}),this.materialProperties)),this.sprite=new r(this.material)}initialize(t){t.body=this.sprite}static fromJSON(t,e){let{loadedTexture:i,materialProperties:s=iD,isEnabled:r=!0}=t;return new i6(e,i,eM(iD,(t=>{let{blending:e}=t;return i8(i8({},t),{},{blending:e?iI[e]:iI[iD.blending]})})(s)),r)}}class i7 extends iC{constructor(t,e=!0){super(t,e),this.dirVec=new iz(0,0,0)}normalize(t){return 100*t}}i7.prototype.initialize=(V=new iz(0,0,1),I=new iz(0,0,0),function(t){return R=this.tha*Math.random(),this._useV&&this.dirVec.copy(this.dir).scalar(this.radiusPan.getValue()),eE.getNormal(this.dirVec,V),I.copy(this.dirVec).applyAxisAngle(V,R),I.applyAxisAngle(this.dirVec.normalize(),6.284*Math.random()),t.velocity.copy(I),this});class st extends i7{constructor(t,e,i=!0){super(ty,i),this.tha=e*tV,this.dirVec=t.toVector3D(),this._useV=!1}static fromJSON(t){let{polarRadius:e,polarTheta:i,polarPhi:s,velocityTheta:r,isEnabled:n=!0}=t;return new st(new i_(e,i,s),r,n)}}class se extends i7{constructor(t,e,i,s=!0){super(tm,s),this.radiusPan=eA(t),this.dir=e.clone().normalize(),this.tha=i*tV,this._useV=!0}static fromJSON(t){let{radius:e,x:i,y:s,z:r,theta:n,isEnabled:o=!0}=t;return new se(e,new iz(i,s,r),n,o)}}class si extends i7{constructor(t,e,i=!0){super(tf,i),this.radiusPan=eA(1),this.dir=t.clone(),this.tha=e*tV,this._useV=!0}static fromJSON(t){let{x:e,y:i,z:s,theta:r,isEnabled:n=!0}=t;return new si(new iz(e,i,s),r,n)}}const ss=new i3(1,.1),sr=void 0;var sn={};sn=function(t){return"number"==typeof t||e$(t)&&"[object Number]"==eL(t)};class so extends iw{constructor(t){super(t),this.type="Emitter",this.particles=[],this.initializers=[],this.behaviours=[],this.emitterBehaviours=[],this.currentEmitTime=0,this.totalEmitTimes=-1,this.damping=.006,this.bindEmitter=!0,this.bindEmitterEvent=!1,this.rate=ss,this.isEmitting=!1,this.id=`emitter-${ez()}`,this.cID=0,this.name="Emitter",this.index=sr,this.eventDispatcher=new iT}dispatch(t,e=this){this.eventDispatcher.dispatchEvent(t,e)}setRate(t){return this.rate=t,this}setPosition(t={}){let{position:e}=this,{x:i=e.x,y:s=e.y,z:r=e.z}=t;return this.position.set(i,s,r),this}setRotation(t={}){let{rotation:e}=this,{x:i=e.x,y:s=e.y,z:r=e.z}=t;return this.rotation.set(i,s,r),this}emit(t=1/0,e=1/0){return this.currentEmitTime=0,this.totalEmitTimes=N(sn)(t)?t:1/0,1===t?this.life=t:this.life=N(sn)(e)?e:1/0,this.rate.init(),this.isEmitting=!0,this}experimental_emit(){let{isEmitting:t,totalEmitTimes:e,life:i}=this;return t||(this.currentEmitTime=0,e||this.setTotalEmitTimes(1/0),i||this.setLife(1/0),this.rate.init(),this.isEmitting=!0),this}setTotalEmitTimes(t=1/0){return this.totalEmitTimes=N(sn)(t)?t:1/0,this}setLife(t=1/0){return 1===this.totalEmitTimes?this.life=this.totalEmitTimes:this.life=N(sn)(t)?t:1/0,this}stopEmit(){this.totalEmitTimes=-1,this.currentEmitTime=0,this.isEmitting=!1}removeAllParticles(){let t=this.particles.length;for(;t--;)this.particles[t].dead=!0}addInitializer(t){return this.initializers.push(t),this}addInitializers(t){let e=t.length;for(;e--;)this.addInitializer(t[e]);return this}setInitializers(t){return this.initializers=t,this}removeInitializer(t){let e=this.initializers.indexOf(t);return e>-1&&this.initializers.splice(e,1),this}removeAllInitializers(){return eu.destroyArray(this.initializers),this}addBehaviour(t){return this.behaviours.push(t),this}addBehaviours(t){let e=t.length;for(;e--;)this.addBehaviour(t[e]);return this}setBehaviours(t){return this.behaviours=t,this}removeBehaviour(t){let e=this.behaviours.indexOf(t);return e>-1&&this.behaviours.splice(e,1),this}removeAllBehaviours(){return eu.destroyArray(this.behaviours),this}addEmitterBehaviour(t){return this.emitterBehaviours.push(t),t.initialize(this),this}addEmitterBehaviours(t){let e=t.length;for(;e--;)this.addEmitterBehaviour(t[e]);return this}setEmitterBehaviours(t){let e=t.length;this.emitterBehaviours=t;for(let t=0;t<e;t++)this.emitterBehaviours[t].initialize(this);return this}removeEmitterBehaviour(t){let e=this.emitterBehaviours.indexOf(t);return e>-1&&this.emitterBehaviours.splice(e,1),this}removeAllEmitterBehaviours(){return eu.destroyArray(this.emitterBehaviours),this}addOnEmitterDeadEventListener(t){return this.eventDispatcher.addEventListener(`${this.id}_${iP}`,()=>t()),this}createParticle(){let t=this.parent.pool.get(iw),e=this.particles.length;return this.setupParticle(t,e),this.parent&&this.parent.dispatch(iO,t),this.bindEmitterEvent&&this.dispatch(iO,t),t}setupParticle(t,e){let{initializers:i,behaviours:s}=this;iN.initialize(this,t,i),t.addBehaviours(s),t.parent=this,t.index=e,this.particles.push(t)}update(t){if(!this.isEmitting)return;this.age+=t,(this.dead||this.age>=this.life)&&this.destroy(),this.generate(t),this.integrate(t);let e=this.particles.length;for(;e--;){let t=this.particles[e];t.dead&&(this.parent&&this.parent.dispatch(iS,t),this.bindEmitterEvent&&this.dispatch(iS,t),this.parent.pool.expire(t.reset()),this.particles.splice(e,1))}this.updateEmitterBehaviours(t)}updateEmitterBehaviours(t){if(this.sleep)return;let e=this.emitterBehaviours.length;for(let i=0;i<e;i++)this.emitterBehaviours[i].applyBehaviour(this,t,i)}integrate(t){let e=this.parent?this.parent.integrationType:iv,i=1-this.damping;ib(this,t,i,e);let s=this.particles.length;for(;s--;){let r=this.particles[s];r.update(t,s),ib(r,t,i,e),this.parent&&this.parent.dispatch(iA,r),this.bindEmitterEvent&&this.dispatch(iA,r)}}generate(t){if(1===this.totalEmitTimes){let t=this.rate.getValue(99999);for(t>0&&(this.cID=t);t--;)this.createParticle();this.totalEmitTimes=0;return}if(this.currentEmitTime+=t,this.currentEmitTime<this.totalEmitTimes){let e=this.rate.getValue(t);for(e>0&&(this.cID=e);e--;)this.createParticle()}}destroy(){this.dead=!0,this.energy=0,this.totalEmitTimes=-1,0==this.particles.length&&(this.isEmitting=!1,this.removeAllInitializers(),this.removeAllBehaviours(),this.dispatch(`${this.id}_${iP}`),this.parent&&this.parent.removeEmitter(this))}}var sa={};U(sa,"Alpha",()=>su),U(sa,"Attraction",()=>sd),U(sa,"Collision",()=>sp),U(sa,"Color",()=>sf),U(sa,"CrossZone",()=>sy),U(sa,"Force",()=>sm),U(sa,"Gravity",()=>sg),U(sa,"RandomDrift",()=>sv),U(sa,"Repulsion",()=>sx),U(sa,"Rotate",()=>sb),U(sa,"Scale",()=>sz),U(sa,"Spring",()=>s_),U(sa,"Behaviour",()=>sl);const sh=1/0,sc="dead";class sl{constructor(t=1/0,e=tk,i="Behaviour",s=!0){this.type=i,this.isEnabled=s,this.id=`behaviour-${ez()}`,this.life=t,this.easing=e,this.age=0,this.energy=1,this.dead=!1}reset(t=sh,e=tk){this.life=t,this.easing=e||tk}set life(t){this._life=N(sn)(t)?t:sh}get life(){return this._life}normalizeForce(t){return t.scalar(100)}normalizeValue(t){return 100*t}initialize(t){}applyBehaviour(t,e,i){this.isEnabled&&this.mutate(t,e,i)}mutate(t,e,i){}energize(t,e){if(this.dead)return;if(this.age+=e,this.age>=this.life){this.energy=0,this.dead=!0;return}let i=this.easing(t.age/t.life);this.energy=Math.max(1-i,0)}destroy(){}fromJSON(t){}}class su extends sl{constructor(t=1,e=null,i,s,r=!0){super(i,s,G,r),this.alphaA=t,this.alphaB=e,this.reset(t,e)}get same(){return this._same}set same(t){this._same=t}reset(t=1,e=null,i,s){this.same=null==e,this.alphaA=eA(t),this.alphaB=eA(e),i&&super.reset(i,s)}initialize(t){t.useAlpha=!0,t.transform.alphaA=this.alphaA.getValue(),t.transform.alphaB=this.same?t.transform.alphaA:this.alphaB.getValue()}mutate(t,e,i){this.energize(t,e,i),t.alpha=eE.lerp(t.transform.alphaA,t.transform.alphaB,this.energy),t.alpha<.002&&(t.alpha=0)}static fromJSON(t){let{alphaA:e,alphaB:i,life:s,easing:r,isEnabled:n=!0}=t;return new su(e,i,s,t8(r),n)}}class sd extends sl{constructor(t=new iz,e=100,i=1e3,s=sh,r=tk,n=!0){super(s,r,W,n),this.targetPosition=t,this.radius=i,this.force=this.normalizeValue(e),this.radiusSq=this.radius*this.radius,this.attractionForce=new iz,this.lengthSq=0}reset(t=new iz,e=100,i=1e3,s,r){this.targetPosition=t,this.radius=i,this.force=this.normalizeValue(e),this.radiusSq=this.radius*this.radius,this.attractionForce=new iz,this.lengthSq=0,s&&super.reset(s,r)}mutate(t,e,i){this.energize(t,e,i),this.attractionForce.copy(this.targetPosition),this.attractionForce.sub(t.position),this.lengthSq=this.attractionForce.lengthSq(),this.lengthSq>4e-6&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.scalar(1-this.lengthSq/this.radiusSq),this.attractionForce.scalar(this.force),t.acceleration.add(this.attractionForce))}static fromJSON(t){let{x:e,y:i,z:s,force:r,radius:n,life:o,easing:a,isEnabled:h=!0}=t;return new sd(new iz(e,i,s),r,n,o,t8(a),h)}}class sp extends sl{constructor(t,e,i,s,r,n=!0){super(s,r,"Collision",n),this.reset(t,e,i)}reset(t,e,i,s,r){this.emitter=t,this.useMass=e,this.onCollide=i,this.particles=[],this.delta=new iz,s&&super.reset(s,r)}mutate(t,e,i){let s,r,n,o,a,h;let c=this.emitter?this.emitter.particles.slice(i):this.particles.slice(i),l=c.length;for(;l--;)(s=c[l])!=t&&(this.delta.copy(s.position).sub(t.position),(r=this.delta.lengthSq())<=(o=t.radius+s.radius)*o&&(n=o-Math.sqrt(r)+.5,a=this._getAverageMass(t,s),h=this._getAverageMass(s,t),t.position.add(this.delta.clone().normalize().scalar(-(n*a))),s.position.add(this.delta.normalize().scalar(n*h)),this.onCollide&&this.onCollide(t,s)))}_getAverageMass(t,e){return this.useMass?e.mass/(t.mass+e.mass):.5}fromJSON(t){}}class sf extends sl{constructor(t,e,i,s,r=!0){super(i,s,$,r),this.reset(t,e)}get same(){return this._same}set same(t){this._same=t}reset(t,e,i,s){this.same=null==e,this.colorA=ig(t),this.colorB=ig(e),i&&super.reset(i,s)}initialize(t){t.transform.colorA=es.getRGB(this.colorA.getValue()),t.useColor=!0,t.transform.colorB=this.same?t.transform.colorA:es.getRGB(this.colorB.getValue())}mutate(t,e,i){this.energize(t,e,i),this._same?(t.color.r=t.transform.colorA.r,t.color.g=t.transform.colorA.g,t.color.b=t.transform.colorA.b):(t.color.r=eE.lerp(t.transform.colorA.r,t.transform.colorB.r,this.energy),t.color.g=eE.lerp(t.transform.colorA.g,t.transform.colorB.g,this.energy),t.color.b=eE.lerp(t.transform.colorA.b,t.transform.colorB.b,this.energy))}static fromJSON(t){let{colorA:e,colorB:i,life:s,easing:r,isEnabled:n=!0}=t;return new sf(e,i,s,t8(r),n)}}class sy extends sl{constructor(t,e,i,s,r){super(i,s,K,r),this.reset(t,e)}reset(t,e=sc,i,s){this.zone=t,this.zone.crossType=e,i&&super.reset(i,s)}mutate(t,e,i){this.energize(t,e,i),this.zone.crossing.call(this.zone,t)}static fromJSON(t){let{zoneType:e,zoneParams:i,crossType:s,life:r,easing:n,isEnabled:o=!0}=t;return new sy(new iX[e](...Object.values(i)),s,r,t8(n),o)}}class sm extends sl{constructor(t,e,i,s,r,n=!0){super(s,r,tt,n),this.reset(t,e,i)}reset(t,e,i){this.force=this.normalizeForce(new iz(t,e,i)),this.force.id=Math.random()}mutate(t,e,i){this.energize(t,e,i),t.acceleration.add(this.force)}static fromJSON(t){let{fx:e,fy:i,fz:s,life:r,easing:n,isEnabled:o=!0}=t;return new sm(e,i,s,r,t8(n),o)}}class sg extends sm{constructor(t,e,i,s=!0){super(0,-t,0,e,i,s),this.type=te}static fromJSON(t){let{gravity:e,life:i,easing:s,isEnabled:r=!0}=t;return new sg(e,i,t8(s),r)}}class sv extends sl{constructor(t,e,i,s=.03,r,n,o=!0){super(r,n,ti,o),this.reset(t,e,i,s),this.time=0}reset(t,e,i,s=.03,r,n){this.randomForce=this.normalizeForce(new iz(t,e,i)),this.delayPan=eA(s),this.time=0,r&&super.reset(r,n)}mutate(t,e,i){if(this.energize(t,e,i),this.time+=e,this.time>=this.delayPan.getValue()){let e=eE.randomAToB(-this.randomForce.x,this.randomForce.x),i=eE.randomAToB(-this.randomForce.y,this.randomForce.y),s=eE.randomAToB(-this.randomForce.z,this.randomForce.z);t.acceleration.addValue(e,i,s),this.time=0}}static fromJSON(t){let{x:e,y:i,z:s,delay:r,life:n,easing:o,isEnabled:a=!0}=t;return new sv(e,i,s,r,n,t8(o),a)}}class sx extends sd{constructor(t,e,i,s,r,n=!0){super(t,e,i,s,r,n),this.force*=-1,this.type=ts}reset(t,e,i,s,r){super.reset(t,e,i,s,r),this.force*=-1}static fromJSON(t){let{x:e,y:i,z:s,force:r,radius:n,life:o,easing:a,isEnabled:h=!0}=t;return new sx(new iz(e,i,s),r,n,o,t8(a),h)}}class sb extends sl{constructor(t,e,i,s,r,n=!0){super(s,r,tr,n),this.reset(t,e,i)}get rotationType(){return this._rotationType}set rotationType(t){this._rotationType=t}reset(t,e,i,s,r){this.x=t||0,this.y=e||0,this.z=i||0,void 0===t||"same"==t?this.rotationType="same":void 0==e?this.rotationType="set":void 0===i?this.rotationType="to":(this.rotationType="add",this.x=eA(this.x*tV),this.y=eA(this.y*tV),this.z=eA(this.z*tV)),s&&super.reset(s,r)}initialize(t){switch(this.rotationType){case"same":break;case"set":this._setRotation(t.rotation,this.x);break;case"to":t.transform.fR=t.transform.fR||new iz,t.transform.tR=t.transform.tR||new iz,this._setRotation(t.transform.fR,this.x),this._setRotation(t.transform.tR,this.y);break;case"add":t.transform.addR=new iz(this.x.getValue(),this.y.getValue(),this.z.getValue())}}_setRotation(t,e){if(t=t||new iz,"random"==e){var i=eE.randomAToB(-3.142,3.142),s=eE.randomAToB(-3.142,3.142),r=eE.randomAToB(-3.142,3.142);t.set(i,s,r)}else e instanceof iz&&t.copy(e)}mutate(t,e,i){switch(this.energize(t,e,i),this.rotationType){case"same":t.rotation||(t.rotation=new iz),t.rotation.eulerFromDir(t.velocity);break;case"set":break;case"to":t.rotation.x=eE.lerp(t.transform.fR.x,t.transform.tR.x,this.energy),t.rotation.y=eE.lerp(t.transform.fR.y,t.transform.tR.y,this.energy),t.rotation.z=eE.lerp(t.transform.fR.z,t.transform.tR.z,this.energy);break;case"add":t.rotation.add(t.transform.addR)}}static fromJSON(t){let{x:e,y:i,z:s,life:r,easing:n,isEnabled:o=!0}=t;return new sb(e,i,s,r,t8(n),o)}}class sz extends sl{constructor(t,e,i,s,r=!0){super(i,s,tn,r),this.reset(t,e)}get same(){return this._same}set same(t){this._same=t}reset(t,e,i,s){this.same=null==e,this.scaleA=eA(t||1),this.scaleB=eA(e),i&&super.reset(i,s)}initialize(t){t.transform.scaleA=this.scaleA.getValue(),t.transform.oldRadius=t.radius,t.transform.scaleB=this.same?t.transform.scaleA:this.scaleB.getValue()}mutate(t,e,i){this.energize(t,e,i),t.scale=eE.lerp(t.transform.scaleA,t.transform.scaleB,this.energy),t.scale<5e-4&&(t.scale=0),t.radius=t.transform.oldRadius*t.scale}static fromJSON(t){let{scaleA:e,scaleB:i,life:s,easing:r,isEnabled:n=!0}=t;return new sz(e,i,s,t8(r),n)}}class s_ extends sl{constructor(t,e,i,s,r,n,o,a=!0){super(n,o,to,a),this.reset(t,e,i,s,r)}reset(t,e,i,s,r){this.pos?this.pos.set(t,e,i):this.pos=new iz(t,e,i),this.spring=s||.1,this.friction=r||.98}mutate(t,e,i){this.energize(t,e,i),t.velocity.x+=(this.pos.x-t.position.x)*this.spring,t.velocity.y+=(this.pos.y-t.position.y)*this.spring,t.velocity.z+=(this.pos.z-t.position.z)*this.spring}static fromJSON(t){let{x:e,y:i,z:s,spring:r,friction:n,life:o,easing:a,isEnabled:h=!0}=t;return new s_(e,i,s,r,n,o,t8(a),h)}}const sw=t=>i3.fromJSON(t),sM=(t,e)=>{let i=[];return t.forEach(t=>{let{type:s,properties:r}=t;if(!t7.includes(s))throw Error(`The initializer type ${s} is invalid or not yet supported`);tg.includes(s)?i.push(ij[s].fromJSON(r,e)):i.push(ij[s].fromJSON(r))}),i},sE=t=>{let e=[];return t.forEach(t=>{let{type:i,properties:s}=t;if(!et.includes(i))throw Error(`The behaviour type ${i} is invalid or not yet supported`);e.push(sa[i].fromJSON(s))}),e};var sO=(t,e,i,s)=>{let{preParticles:r=500,integrationType:n=tI,emitters:o=[]}=t,a=new i(e,r,n);return o.forEach(t=>{let i=new s,{rate:r,rotation:n,initializers:o,behaviours:h,emitterBehaviours:c=[],position:l,totalEmitTimes:u=1/0,life:d=1/0}=t;i.setRate(sw(r)).setRotation(n).setInitializers(sM(o,e)).setBehaviours(sE(h)).setEmitterBehaviours(sE(c)).setPosition(l).emit(u,d),a.addEmitter(i)}),a};function sA(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function sS(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?sA(Object(i),!0).forEach(function(e){N(ei)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):sA(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}const sP={shouldAutoEmit:!0},sT=t=>i3.fromJSON(t),sj=(t,e)=>new Promise((i,s)=>{if(!t.length)return i([]);let r=t.length,n=[],o=t.filter(({properties:t})=>!t.texture),a=t.filter(({properties:t})=>t.texture);o.forEach(t=>{let{type:o,properties:a}=t;return t7.includes(o)?(tg.includes(o)?n.push(ij[o].fromJSON(a,e)):n.push(ij[o].fromJSON(a)),n.length===r)?i(n):void 0:s(`The initializer type ${o} is invalid or not yet supported`)}),a.forEach(t=>{let{type:o,properties:a,properties:{texture:h}}=t,c=new e.TextureLoader;if(!t7.includes(o))return s(`The initializer type ${o} is invalid or not yet supported`);c.load(h,t=>{if(n.push(i6.fromJSON(sS(sS({},a),{},{loadedTexture:t}),e)),n.length===r)return i(n)},void 0,s)})}),sC=t=>new Promise((e,i)=>{if(!t.length)return e([]);let s=t.length,r=[];t.forEach(t=>{let{type:n,properties:o}=t;return et.includes(n)?(r.push(sa[n].fromJSON(o)),r.length===s)?e(r):void 0:i(`The behaviour type ${n} is invalid or not yet supported`)})}),sB=(t,e,i,s)=>new Promise((r,n)=>{if(!t.length)return r([]);let o=[],a=t.length;if(!a)return r(o);t.forEach(t=>{let h=new e,{rate:c,rotation:l,initializers:u,behaviours:d,emitterBehaviours:p=[],position:f,totalEmitTimes:y=1/0,life:m=1/0}=t;h.setRate(sT(c)).setRotation(l).setPosition(f),sj(u,i).then(t=>(h.setInitializers(t),sC(d))).then(t=>(h.setBehaviours(t),sC(p))).then(t=>(h.setEmitterBehaviours(t),Promise.resolve(h))).then(t=>{if(o.push(s?t.emit(y,m):t.setTotalEmitTimes(y).setLife(m)),o.length===a)return r(o)}).catch(n)})});var sR=(t,e,i,s,r={})=>new Promise((n,o)=>{let{preParticles:a=500,integrationType:h=tI,emitters:c=[]}=t,l=new i(a,h),{shouldAutoEmit:u}=sS(sS({},sP),r);sB(c,s,e,u).then(t=>{let e=t.length;if(!e)return n(l);t.forEach(t=>{l.addEmitter(t),l.emitters.length===e&&n(l)})}).catch(o)});class sV{constructor(t=500,e=iv){this.type="System",this.canUpdate=!0,this.preParticles=t,this.integrationType=e,this.emitters=[],this.renderers=[],this.pool=new iM,this.eventDispatcher=new iT}static fromJSON(t,e){return sO(t,e,sV,so)}static fromJSONAsync(t,e,i){return sR(t,e,sV,so,i)}dispatch(t,e=this){this.eventDispatcher.dispatchEvent(t,e)}addRenderer(t){return this.renderers.push(t),t.init(this),this}removeRenderer(t){return this.renderers.splice(this.renderers.indexOf(t),1),t.remove(this),this}addEmitter(t){let e=this.emitters.length;return t.parent=this,t.index=e,this.emitters.push(t),this.dispatch("EMITTER_ADDED",t),this}removeEmitter(t){return t.parent!==this||(t.parent=null,t.index=void 0,this.emitters.splice(this.emitters.indexOf(t),1),this.dispatch("EMITTER_REMOVED",t)),this}emit({onStart:t,onUpdate:e,onEnd:i}){t&&t(),e&&this.eventDispatcher.addEventListener(iE,e);let s=this.emitters.map(t=>{let{life:e}=t;return e===1/0?(i&&i(),t.experimental_emit(),Promise.resolve()):new Promise(e=>{t.addOnEmitterDeadEventListener(()=>{i&&i(),e()}),t.experimental_emit()})});try{return Promise.all(s)}catch(t){console.warn(t)}}update(t=.0167){let e=t||.0167;if(this.canUpdate){if(e>0){let t=this.emitters.length;for(;t--;){let i=this.emitters[t];i.update(e),i.isEmitting&&this.dispatch(iE)}}this.dispatch("SYSTEM_UPDATE_AFTER")}return Promise.resolve()}getCount(){let t;let e=this.emitters.length,i=0;for(t=0;t<e;t++)i+=this.emitters[t].particles.length;return i}destroy(){let t=this.emitters.length;this.canUpdate=!1;for(let e=0;e<t;e++)this.emitters[e]&&this.emitters[e].destroy(),delete this.emitters[e];for(let e=0;e<t;e++)this.renderers[e]&&this.renderers[e].destroy&&(this.renderers[e].destroy(),delete this.renderers[e]);this.emitters.length=0,this.pool.destroy(),this.canUpdate=!0}}class sI{constructor(t="BaseRenderer"){this.type=t}init(t){var e=this;this.system=t,this.system.eventDispatcher.addEventListener(iE,function(t){e.onSystemUpdate.call(e,t)}),this.system.eventDispatcher.addEventListener(iO,function(t){e.onParticleCreated.call(e,t)}),this.system.eventDispatcher.addEventListener(iA,function(t){e.onParticleUpdate.call(e,t)}),this.system.eventDispatcher.addEventListener(iS,function(t){e.onParticleDead.call(e,t)}),this.logRendererType()}remove(){this.system=null}onParticleCreated(t){}onParticleUpdate(t){}onParticleDead(t){}onSystemUpdate(t){}logRendererType(){tF&&console.log(`${this.type}`)}}class sF extends sI{constructor(t,e){super("MeshRenderer"),this.container=t,this._targetPool=new iM,this._materialPool=new iM,this._body=new e.Mesh(new e.BoxGeometry(50,50,50),new e.MeshLambertMaterial({color:"#ff0000"}))}isThreeSprite(t){return t.target.isSprite}onSystemUpdate(){}onParticleCreated(t){!t.target&&(t.body||(t.body=this._body),t.target=this._targetPool.get(t.body),(t.useAlpha||t.useColor)&&(t.target.material.__puid=er.id(t.body.material),t.target.material=this._materialPool.get(t.target.material))),t.target&&(t.target.position.copy(t.position),this.container.add(t.target))}onParticleUpdate(t){let{target:e,useAlpha:i,useColor:s,rotation:r}=t;e&&(e.position.copy(t.position),this.isThreeSprite(t)||e.rotation.set(r.x,r.y,r.z),this.scale(t),i&&(e.material.opacity=t.alpha,e.material.transparent=!0),s&&e.material.color.copy(t.color))}scale(t){t.target.scale.set(t.scale,t.scale,t.scale)}onParticleDead(t){t.target&&((t.useAlpha||t.useColor)&&this._materialPool.expire(t.target.material),this._targetPool.expire(t.target),this.container.remove(t.target),t.target=null)}}class sD extends sF{constructor(t,e){super(t,e),this.type="SpriteRenderer",this._body=new e.Sprite(new e.SpriteMaterial({color:16777215}))}scale(t){t.target.scale.set(t.scale*t.radius,t.scale*t.radius,1)}}[12,4,16].reduce((t,e)=>t+e),[3,1,4,1,2].reduce((t,e)=>t+e);var H=Y("ilwiq"),sk=()=>((e=new H.PerspectiveCamera(1e3,window.innerWidth/window.innerHeight,10,1e3)).position.z=20,t=new H.Scene,(i=new H.WebGLRenderer({antialias:!0})).domElement.classList.add("three-renderer"),document.body.appendChild(i.domElement),i.setPixelRatio(window.devicePixelRatio),i.setSize(window.innerWidth,window.innerHeight),i.setClearColor(0,0),{scene:t,camera:e,renderer:i}),sZ={};sZ=JSON.parse('{"headerState":{"projectName":"E:\\\\Mobeen\\\\O3- Web particles (Nebula)\\\\Nebula-particles-3","version":{"loading":false,"error":null,"data":{"version":"1.0.8-alpha"}},"release":{"loading":false,"error":null,"data":null},"shouldShowReleaseDownloadDialog":false},"particleSystemState":{"preParticles":500,"integrationType":"EULER","emitters":[{"id":"ebbf1b40-143f-11ef-acd5-4b9c3d18cc87","totalEmitTimes":null,"life":null,"cache":{"totalEmitTimes":0,"life":0},"rate":{"particlesMin":1,"particlesMax":10,"perSecondMin":0.01,"perSecondMax":0.02},"position":{"x":-40,"y":0,"z":13},"rotation":{"x":0,"y":1,"z":0},"initializers":[{"id":"ebbf1b41-143f-11ef-acd5-4b9c3d18cc87","type":"Mass","properties":{"min":30,"max":10,"isEnabled":true}},{"id":"ebbf1b42-143f-11ef-acd5-4b9c3d18cc87","type":"Life","properties":{"min":2,"max":5,"isEnabled":true}},{"id":"ebbf1b43-143f-11ef-acd5-4b9c3d18cc87","type":"BodySprite","properties":{"texture":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAJkSURBVHjaxJeJbusgEEW94S1L//83X18M2MSuLd2pbqc4wZGqRLrKBsyZhQHny7Jk73xVL8xpVhWrcmiB5lX+6GJ5YgQ2owbAm8oIwH1VgKZUmGcRqKGGPgtEQQAzGR8hQ59fAmhJHSAagigJ4E7GPWRXOYC6owAd1JM6wDQPADyMWUqZRMqmAojHp1Vn6EQQEgUNMJLnUjMyJsM49wygBkAPw9dVFwXRkncCIIW3GRgoTQUZn6HxCMAFEFd8TwEQ78X4rHbILoAUmeT+RFG4UhQ6MiIAE4W/UsYFjuVjAIa2nIY4q1R0GFtQWG3E84lqw2GO2QOoCKBVu0BAPgDSU0eUDjjQenNkV/AW/pWChhpMTelo1a64AOKM30vk18GzTHXCNtI/Knz3DFBgsUqBGIjTInXRY1yA9xkVoqW5tVq3pDR9A0hfF5BSARmVnh7RMDCaIdcNgbPBkgzn1Bu+SfIEFSpSBmkxyrMicb0fAEuCZrWnN89veA/4XcakrPcjBWzkTuLjlbfTQPOlBhz+HwkqqPXmPQDdrQItxE1moGof1S74j/8txk8EHhTQrAE8qlwfqS5yukm1x/rAJ9Jiaa6nyATqD78aUVBhFo8b1V4DdTXdCW+IxA1zB4JhiOhZMEWO1HqnvdoHZ4FAMIhV9REF8FiUm0jsYPEJx/Fm/N8OhH90HI9YRHesWbXXZwAShU8qThe7H8YAuJmw5yOd989uRINKRTJAhoF8jbqrHKfeCYdIISZfSq26bk/K+yO3YvfKrVgiwQBHnwt8ynPB25+M8hceTt/ybPhnryJ78+tLgAEAuCFyiQgQB30AAAAASUVORK5CYII=","isEnabled":true}},{"id":"ebbf1b44-143f-11ef-acd5-4b9c3d18cc87","type":"Radius","properties":{"width":0.2,"height":0.8,"isEnabled":true,"center":true}},{"id":"ebbf1b45-143f-11ef-acd5-4b9c3d18cc87","type":"RadialVelocity","properties":{"radius":8,"x":0,"y":0,"z":1,"theta":100,"isEnabled":true}},{"id":"fc13f1d0-1441-11ef-acd5-4b9c3d18cc87","type":"PolarVelocity","properties":{"polarRadius":4,"polarTheta":50,"polarPhi":1,"velocityTheta":10,"isEnabled":true}}],"behaviours":[{"id":"ebbf1b46-143f-11ef-acd5-4b9c3d18cc87","type":"Alpha","properties":{"alphaA":1,"alphaB":0,"life":null,"easing":"easeLinear"}},{"id":"ebbf1b47-143f-11ef-acd5-4b9c3d18cc87","type":"Color","properties":{"colorA":"#ffffff","colorB":"#e5e7f1","life":null,"easing":"easeLinear"}},{"id":"ebbf1b48-143f-11ef-acd5-4b9c3d18cc87","type":"Scale","properties":{"scaleA":0.5,"scaleB":0.5,"life":null,"easing":"easeLinear"}},{"id":"ebbf1b49-143f-11ef-acd5-4b9c3d18cc87","type":"Force","properties":{"fx":1,"fy":0,"fz":0,"life":null,"easing":"easeLinear"}},{"id":"ebbf1b4a-143f-11ef-acd5-4b9c3d18cc87","type":"Rotate","properties":{"x":0,"y":0,"z":0,"life":null,"easing":"easeLinear"}},{"id":"ebbf1b4b-143f-11ef-acd5-4b9c3d18cc87","type":"RandomDrift","properties":{"driftX":1.1,"driftY":0,"driftZ":0,"delay":1,"life":null,"easing":"easeLinear"}},{"id":"ebbf1b4c-143f-11ef-acd5-4b9c3d18cc87","type":"Spring","properties":{"x":0,"y":0,"z":5,"spring":0.01,"friction":1,"life":null,"easing":"easeLinear"}}],"emitterBehaviours":[{"id":"ebbf1b4d-143f-11ef-acd5-4b9c3d18cc87","type":"Rotate","properties":{"x":0,"y":0,"z":0,"life":null,"easing":"easeLinear"}}]}]}}'),sV.fromJSONAsync(N(sZ).particleSystemState,H).then(t=>{console.log("Loaded:",t);let e=sk(),i=new sD(e.scene,H),s=t.addRenderer(i);console.log("Nebula:",s),window.addEventListener("resize",()=>{e.renderer.setSize(window.innerWidth,window.innerHeight),e.camera.aspect=window.innerWidth/window.innerHeight,e.camera.updateProjectionMatrix()}),function t(e,i){requestAnimationFrame(()=>t(e,i)),e.update(),i.renderer.render(i.scene,i.camera)}(s,e)});
//# sourceMappingURL=index.56c6bc4c.js.map
